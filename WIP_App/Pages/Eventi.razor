@page "/eventi"


@if (EventoCorrente == null)
{
    <ListaEventi ListaElementi="ListaEventi" OnElimina="EliminaEvento"
                 OnCrea="CreaEvento" OnModifica="ModificaEvento" />
}
else
{
    <DettaglioEvento DettaglioElemento="EventoCorrente"
                     OnSalva="SalvaEvento" OnAnnulla="AnnullaOperazione" />
}



@code {
    [Parameter]
    public string timeReset { get; set; } = "00:00";

    public Evento EventoCorrente { get; set; }




    public void CreaEvento()
    {
        this.EventoCorrente = new Evento();
        this.EventoCorrente.Data = DateTime.Now;
        this.EventoCorrente.Ora = timeReset;
    }



    public void EliminaEvento(ElementoListaEventi evento)
    {
        this.ListaEventi.Remove(evento);
    }



    public void ModificaEvento(ElementoListaEventi evento)
    {
        this.EventoCorrente = new Evento()
        {
            Id = evento.Id,
            Data = evento.Data,
            Ora = evento.Ora,
            Nome = evento.Nome,
            Localita = evento.Localita,
            Descrizione = evento.Descrizione,
            Note = evento.Note

        };
    }

    public void SalvaEvento(Evento evento)
    {
        if (evento.Id == 0)
        {
            this.ListaEventi.Add(new ElementoListaEventi()
            {
                Id = this.ListaEventi.Count() > 0 ? this.ListaEventi.Max(x => x.Id) + 1 : 1,
                Data = evento.Data,
                Ora = evento.Ora,
                Nome = evento.Nome,
                Localita = evento.Localita,
                Descrizione = evento.Descrizione,
                Note = evento.Note


            });
        }
        else
        {
            var eventoDaModificare = this.ListaEventi.Single(x => x.Id == evento.Id);
            eventoDaModificare.Data = evento.Data;
            eventoDaModificare.Ora = evento.Ora;
            eventoDaModificare.Nome = evento.Nome;
            eventoDaModificare.Localita = evento.Localita;
            eventoDaModificare.Descrizione = evento.Descrizione;
            eventoDaModificare.Note = evento.Note;


        }
        this.EventoCorrente = null;
    }



    public void AnnullaOperazione()
    {
        this.EventoCorrente = null;
    }








    List<ElementoListaEventi> ListaEventi { get; set; }
       = new List<ElementoListaEventi>
           {
                new ElementoListaEventi()
                { Id = 1,
                    Data = new DateTime(2021, 2,22),
                    Ora = "10:30",
                    Nome="Assoservizi",
                    Localita="Arezzo",
                    Descrizione="Inizio stage",
                    Note=" Ritiro Registro presenze"

                },
                new ElementoListaEventi()
                { Id = 2,
                    Data = new DateTime(2021, 4, 21),
                    Ora = "11:30",
                    Nome="Daniele Simoncini",
                    Localita="San Giovanni Valdarno",
                    Descrizione="Fine stage",
                    Note="Firmare Registro presenze"

                },
                new ElementoListaEventi()
                { Id = 3,
                    Data = new DateTime(2021, 5, 20),
                    Ora = "11:00",
                    Nome="Marinella Guerra",
                    Localita="Arezzo",
                    Descrizione="Esami",
                    Note="Consegnare registro presenze"

                },

                new ElementoListaEventi()
                { Id = 4,
                    Data = new DateTime(2021, 5, 20),
                    Ora = "12:00",
                    Nome="Azienda X",
                    Localita="Arezzo",
                    Descrizione="Colloquio",
                    Note="portare CV"

                },
                new ElementoListaEventi()
                { Id = 5,
                    Data = new DateTime(2021, 5, 20),
                    Ora = "12:00",
                    Nome="Azienda X",
                    Localita="Arezzo",
                    Descrizione="Colloquio",
                    Note="portare CV"

                },
                new ElementoListaEventi()
                { Id = 6,
                    Data = new DateTime(2021, 5, 20),
                    Ora = "12:00",
                    Nome="Azienda X",
                    Localita="Arezzo",
                    Descrizione="Colloquio",
                    Note="portare CV"

                },new ElementoListaEventi()
                { Id = 7,
                    Data = new DateTime(2021, 5, 20),
                    Ora = "12:00",
                    Nome="Azienda X",
                    Localita="Arezzo",
                    Descrizione="Colloquio",
                    Note="portare CV"

                },new ElementoListaEventi()
                { Id = 8,
                    Data = new DateTime(2021, 5, 20),
                    Ora = "12:00",
                    Nome="Azienda X",
                    Localita="Arezzo",
                    Descrizione="Colloquio",
                    Note="portare CV"

                },
                new ElementoListaEventi()
                { Id = 9,
                    Data = new DateTime(2021, 5, 20),
                    Ora = "12:00",
                    Nome="Azienda X",
                    Localita="Arezzo",
                    Descrizione="Colloquio",
                    Note="portare CV"

                },new ElementoListaEventi()
                { Id = 10,
                    Data = new DateTime(2021, 5, 20),
                    Ora = "12:00",
                    Nome="Azienda X",
                    Localita="Arezzo",
                    Descrizione="Colloquio",
                    Note="portare CV"

                }
               };




}
